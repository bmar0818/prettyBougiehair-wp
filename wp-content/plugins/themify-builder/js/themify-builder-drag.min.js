var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,g,d){a instanceof String&&(a=String(a));for(var l=a.length,k=0;k<l;k++){var v=a[k];if(g.call(d,v,k,a))return{i:k,v:v}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,g,d){a!=Array.prototype&&a!=Object.prototype&&(a[g]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,g,d,l){if(g){d=$jscomp.global;a=a.split(".");for(l=0;l<a.length-1;l++){var k=a[l];k in d||(d[k]={});d=d[k]}a=a[a.length-1];l=d[a];g=g(l);g!=l&&null!=g&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:g})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6-impl","es3");
(function(a,g,d,l){function k(b,c){this.element=a(b);this.options=a.extend({},A,c);this.init()}var v="desktop",r,n=!1,z,w=!0,q=!1,f,e,x,y,u,m,t=a(g.document),p,A={append:!0,dropitems:null,elements:null,type:"",cancel:null,onDragStart:null,onDrag:null,onDragEnter:null,onDragLeave:null,onDragEnd:null,onDrop:null};k.prototype={init:function(){!1===q&&(u=a("<div/>",{id:"tb_placeholder_body","class":"tb_placeholder_helper"}),q=a("<div/>",{id:"tb_placeholder_iframe","class":"tb_placeholder_helper"}),p=
a("body"),p.prepend(q).on("themify_builder_change_mode",this.changeMode),x=l.toolbar.$el,y=a("#tb_fixed_bottom_scroll",t),a("body",t).append(u));this.element.off("mousedown.tb_visual").on("mousedown.tb_visual",this.mouseDown.bind(this))},elpos:{},is_enter:!1,first:null,size:{w:"",h:""},mouseDown:function(b){1!==b.which||b.target.classList.contains("tb_disable_sorting")?f=m=e=null:(b.preventDefault(),f=this.element,n=!1,this.first=null,w=!1,this.elpos=f.offset(),t.one("mousemove.tb_visual",this.firstMove.bind(this)).one("mouseup.tb_visual",
this.mouseUp.bind(this)))},firstMove:function(b){b.preventDefault();b.stopPropagation();if(f){a.isFunction(this.options.onDragBefore)&&this.options.onDragBefore.call(this,b,f);var c=f[0].outerHTML;q.removeClass("drop_animate").hide().html(c);u.removeClass("drop_animate").hide().html(c);c=a("body",t);c=c.add(a("body"));c.addClass("tb_drag_start tb_drag_"+this.options.type);this.setCurrentPlaceHolder(b);m.show();this.size.w=m.outerWidth()/2;this.size.h=m.outerHeight();a(d).on("mousemove.tb_visual",
this.mouseMove.bind(this)).on("mouseup.tb_visual",this.mouseUp.bind(this)).on("mouseenter.tb_visual",this.iframeEnter.bind(this)).on("mouseleave.tb_visual",this.iframeLeave.bind(this)).on("mouseenter.tb_visual",this.options.dropitems,this.mouseEnter.bind(this)).on("mouseleave.tb_visual",this.options.dropitems,this.mouseLeave.bind(this));t.on("mousemove.tb_visual",this.mouseMove.bind(this)).on("mouseup.tb_visual",this.mouseUp.bind(this));y.on("mouseenter.tb_visual",this.scroll.bind(this)).on("mouseleave.tb_visual",
this.scrollUp.bind(this));x.on("mouseenter.tb_visual",this.scroll.bind(this)).on("mouseleave.tb_visual",this.scrollUp.bind(this));this.mouseMove(b);a.isFunction(this.options.onDragStart)&&this.options.onDragStart.call(this,b,f)}},mouseMove:function(b){if(f&&m)if(n){var c=this;var h=p.add(p.closest("html"));h.stop().animate({scrollTop:n},{duration:800,step:function(d){n?(d="down"===r?y.offset().top-z:x.offset().top+z,m.css("top",d)):h.stop();a.isFunction(c.options.onDrag)&&c.options.onDrag.call(c,
b,f,e)},complete:function(){c.checkScrollEnd()||(h.stop(),n=r=!1,c.setPlaceHolder(b))}})}else{if(this.is_enter&&this.options.elements&&e){c=this;for(var d=this.is_enter.find(this.options.dropitems+","+this.options.elements).get().reverse(),g=0,l=d.length;g<l;++g){var k=a(d[g]);if(c.CheckIntersect(b,k)&&(!c.options.cancel||0===k.closest(c.options.cancel).length)){c.removeAttr();e=k;break}}}this.setPlaceHolder(b)}},SetSide:function(b){var a=e[0].getBoundingClientRect();b=.5<(b.clientY-a.top)/(a.bottom-
a.top-20)?"bottom":"top";"top"===b&&e[0].parentNode===this.is_enter[0]&&0===e.index()&&(e=this.is_enter);e[0].dataset.pos!==b&&e.attr("data-pos",b)},setCurrentPlaceHolder:function(){m=w?q:u},setPlaceHolder:function(b){var c=void 0!==b.originalEvent?b.originalEvent:b;m.css({top:c.pageY-this.size.h-12,left:c.pageX-this.size.w});e&&this.SetSide(b);a.isFunction(this.options.onDrag)&&this.options.onDrag.call(this,b,f,e)},removeAttr:function(){for(var b=d.querySelectorAll("[data-pos]"),a=b.length-1;-1<
a;--a)b[a].removeAttribute("data-pos")},mouseUp:function(b){a(d).off(".tb_visual");t.off(".tb_visual");y.off(".tb_visual");x.off(".tb_visual");if(f&&m&&!b.isTrigger){b.stopPropagation();b={};var c=f.clone();e?(b.top=e.offset().top,b.left=e.offset().left,"bottom"===e[0].dataset.pos&&(b.top+=e.outerHeight())):(b.top=this.elpos.top,b.left=this.elpos.left);this.is_enter=n=f=null;var h=this;m.addClass("drop_animate").css(b).one(l.Utils.transitionPrefix(),function(b){var d=a("body",t),d=d.add("body");"row"===
h.options.type&&setTimeout(function(){l.toolbar.$el.find('.tb_zoom[data-zoom="100"]').trigger("click")},1E3);d.removeClass("tb_drag_start tb_drag_"+h.options.type);e&&e[0].dataset.pos?(c.hide(),"bottom"===e[0].dataset.pos?h.options.append&&!e[0].classList.contains(h.options.elements.replace(".",""))?e.append(c):e.after(c):h.options.append&&!e[0].classList.contains(h.options.elements.replace(".",""))?e.prepend(c):e.before(c),h.removeAttr(),a.isFunction(h.options.onDrop)&&h.options.onDrop.call(h,b,
c,e),e=null):a.isFunction(h.options.onDragEnd)&&h.options.onDragEnd.call(h,b,c);q.empty().removeAttr("style");u.empty().removeAttr("style")})}},mouseEnter:function(b){f&&m&&(b.stopPropagation(),a(d).triggerHandler("mouseenter.tb_visual"),e=this.is_enter=a(b.currentTarget),this.removeAttr(),this.SetSide(b),a.isFunction(this.options.onDragEnter)&&this.options.onDragEnter.call(this,b,f,e))},mouseLeave:function(b){var c=a(b.currentTarget);if(f&&e&&!this.CheckIntersect(b,c)){var d=c.parent().closest(this.options.dropitems);
0<d.length&&this.CheckIntersect(b,d)?d.trigger("mouseenter.tb_visual"):(this.is_enter=null,this.removeAttr(),e=!1,a.isFunction(this.options.onDragLeave)&&this.options.onDragLeave.call(this,b,f,c))}},scroll:function(b){if(f&&m){var c=parseInt((p.height()-a(g).height())/5);b=a(b.currentTarget);"tb_fixed_bottom_scroll"===b.prop("id")?(n="+="+c+"px",r="down"):(n="-="+c+"px",r="up");0<c?z=b.height():n=!1}},checkScrollEnd:function(){var b=p.scrollTop();return"up"===r&&0!==b||"down"===r&&a(g).height()+b!==
p.height()},CheckIntersect:function(b,a){var c=a.offset();return b.pageX>=c.left&&b.pageX<=c.left+a.outerWidth()&&b.pageY>=c.top&&b.pageY<=c.top+a.outerHeight()},scrollUp:function(b){f&&m&&(n=r=!1,p.add(p.closest("html")).stop())},iframeEnter:function(b){f&&m&&(b.stopPropagation(),w=!0,u.hide(),q.show(),this.setCurrentPlaceHolder(),null===this.first&&(this.first=!0,this.mouseMove(b)))},iframeLeave:function(b){if(f&&m){b.stopPropagation();var a=this;setTimeout(function(){w=r?("desktop"===v||"block"===
q.css("display"))&&a.checkScrollEnd():!1;w||(q.hide(),u.show(),a.setCurrentPlaceHolder())},5)}},changeMode:function(b,c,d){v=d;p="desktop"===v?a("body"):a("body",t)}};a.fn.ThemifyDraggable=function(b){for(var c=this.length-1;-1<c;--c)a.data(this[c],"plugin_ThemifyDraggable")||a.data(this[c],"plugin_ThemifyDraggable",new k(this[c],b));return this}})(jQuery,window.top,document,tb_app);
